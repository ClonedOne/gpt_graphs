Here are the requested outputs:

First output:
Layer 0: [0]
Neighbors of 0: [1, 4]
Index of 1: 0
Index of 4: 1
Median of indices: 0.5

Second output:
Layer 0:
0 -> 0.5
Layer 1:
1 -> 0
4 -> 1
Layer 2:
3 -> 0
5 -> 1
9 -> 2
Layer 3:
2 -> NaN
Layer 4:
7 -> NaN
Layer 5:
8 -> NaN
Layer 6:
6 -> NaN

Third output:
Layer 0: [0]
Layer 1: [1, 4]
Layer 2: [3, 5, 9]
Layer 3: [2]
Layer 4: [7]
Layer 5: [8]
Layer 6: [6]